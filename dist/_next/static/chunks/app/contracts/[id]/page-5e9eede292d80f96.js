(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[589],{91085:function(e,t,a){Promise.resolve().then(a.bind(a,84452))},84452:function(e,t,a){"use strict";a.d(t,{ContractDetails:function(){return p}});var i=a(57437),s=a(2265),l=a(53775),n=a(5978),d=a(20407),r=a(66070),o=a(62869),c=a(32660),u=a(99376),m=a(93022),v=a(65613);function p(e){let{id:t}=e,[a,p]=(0,s.useState)(null),[h,N]=(0,s.useState)(!0),[b,D]=(0,s.useState)(null),f=(0,u.useRouter)();return((0,s.useEffect)(()=>{let e=async()=>{try{var e,a,i,s,l,r,o;N(!0),D(null);let c=(0,n.JU)(d.db,"Contracts",t),u=await (0,n.QT)(c);if(!u.exists()){D("Contract not found");return}let m=u.data(),v=(0,n.IO)((0,n.hJ)(d.db,"Members"),(0,n.ar)("idNumber","==",m.memberIdNumber)),h=await (0,n.PL)(v),b=null===(e=h.docs[0])||void 0===e?void 0:e.data(),f=(0,n.JU)(d.db,"Policies",m.policiesId),y=(await (0,n.QT)(f)).data(),x=(0,n.IO)((0,n.hJ)(d.db,"Beneficiaries"),(0,n.ar)("contractNumber","==",m.contractNumber)),g=(await (0,n.PL)(x)).docs.map(e=>e.data()),j=(0,n.IO)((0,n.hJ)(d.db,"Dependents"),(0,n.ar)("contractNumber","==",m.contractNumber)),C=(await (0,n.PL)(j)).docs.map(e=>e.data()),O=await Promise.all((m.cateringOptionIds||[]).map(async e=>{let t=(0,n.JU)(d.db,"catering",e),a=await (0,n.QT)(t);return{id:e,...a.data()}})),w={mainMember:{personalInfo:{title:(null==b?void 0:b.title)||"",firstName:(null==b?void 0:b.firstName)||"",lastName:(null==b?void 0:b.lastName)||"",initials:(null==b?void 0:b.initials)||"",dateOfBirth:(null==b?void 0:null===(a=b.dateOfBirth)||void 0===a?void 0:a.toDate())||null,gender:(null==b?void 0:b.gender)||"",language:(null==b?void 0:b.language)||"",maritalStatus:(null==b?void 0:b.maritalStatus)||"",nationality:(null==b?void 0:b.nationality)||"",idType:(null==b?void 0:b.idType)||"South African ID",idNumber:(null==b?void 0:b.idNumber)||"",idDocumentUrl:(null==b?void 0:b.idDocumentUrl)||null},contactDetails:(null==b?void 0:b.contactDetails)||[],addressDetails:{streetAddress:(null==b?void 0:null===(i=b.addressDetails)||void 0===i?void 0:i.streetAddress)||"",city:(null==b?void 0:null===(s=b.addressDetails)||void 0===s?void 0:s.city)||"",stateProvince:(null==b?void 0:null===(l=b.addressDetails)||void 0===l?void 0:l.stateProvince)||"",postalCode:(null==b?void 0:null===(r=b.addressDetails)||void 0===r?void 0:r.postalCode)||"",country:(null==b?void 0:null===(o=b.addressDetails)||void 0===o?void 0:o.country)||""},contractNumber:m.contractNumber,contractId:u.id},beneficiaries:g.map(e=>{var t,a,i,s,l,n;return{personalInfo:{title:e.title||"",firstName:e.firstName||"",lastName:e.lastName||"",initials:e.initials||"",dateOfBirth:(null===(t=e.dateOfBirth)||void 0===t?void 0:t.toDate())||null,gender:e.gender||"",relationshipToMainMember:e.relationshipToMainMember||"",nationality:e.nationality||"",idType:e.idType||"South African ID",idNumber:e.idNumber||"",beneficiaryPercentage:e.beneficiaryPercentage||0,idDocumentUrl:e.idDocumentUrl||null},contactDetails:e.contactDetails||[],addressDetails:{streetAddress:(null===(a=e.addressDetails)||void 0===a?void 0:a.streetAddress)||"",city:(null===(i=e.addressDetails)||void 0===i?void 0:i.city)||"",stateProvince:(null===(s=e.addressDetails)||void 0===s?void 0:s.stateProvince)||"",postalCode:(null===(l=e.addressDetails)||void 0===l?void 0:l.postalCode)||"",country:(null===(n=e.addressDetails)||void 0===n?void 0:n.country)||""}}}),dependents:C.map(e=>{var t,a,i,s,l,n;return{personalInfo:{firstName:e.firstName||"",lastName:e.lastName||"",initials:e.initials||"",dateOfBirth:(null===(t=e.dateOfBirth)||void 0===t?void 0:t.toDate())||null,gender:e.gender||"",relationshipToMainMember:e.relationshipToMainMember||"",nationality:e.nationality||"",idType:e.idType||"South African ID",idNumber:e.idNumber||"",dependentStatus:e.dependentStatus||"Active",medicalAidNumber:e.medicalAidNumber,employer:e.employer,school:e.school,idDocumentUrl:e.idDocumentUrl||null},contactDetails:e.contactDetails||[],addressDetails:{streetAddress:(null===(a=e.addressDetails)||void 0===a?void 0:a.streetAddress)||"",city:(null===(i=e.addressDetails)||void 0===i?void 0:i.city)||"",stateProvince:(null===(s=e.addressDetails)||void 0===s?void 0:s.stateProvince)||"",postalCode:(null===(l=e.addressDetails)||void 0===l?void 0:l.postalCode)||"",country:(null===(n=e.addressDetails)||void 0===n?void 0:n.country)||""}}}),policiesDetails:{policiesId:(null==y?void 0:y.id)||"",name:(null==y?void 0:y.name)||"",coverAmount:(null==y?void 0:y.coverAmount)||"",premium:(null==y?void 0:y.premium)||null},cateringOptions:O,status:m.status};p(w)}catch(e){console.error("Error fetching contract details:",e),D("Failed to load contract details")}finally{N(!1)}};t&&e()},[t]),h)?(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsxs)(o.z,{variant:"ghost",onClick:()=>f.back(),className:"mb-4",children:[(0,i.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Back to Contracts"]}),(0,i.jsx)(r.Zb,{children:(0,i.jsxs)("div",{className:"p-6 space-y-6",children:[(0,i.jsx)(m.O,{className:"h-4 w-[250px]"}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)(m.O,{className:"h-4 w-[200px]"}),(0,i.jsx)(m.O,{className:"h-4 w-[300px]"}),(0,i.jsx)(m.O,{className:"h-4 w-[250px]"})]})]})})]}):b||!a?(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsxs)(o.z,{variant:"ghost",onClick:()=>f.back(),className:"mb-4",children:[(0,i.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Back to Contracts"]}),(0,i.jsxs)(v.bZ,{variant:"destructive",children:[(0,i.jsx)(v.Cd,{children:"Error"}),(0,i.jsx)(v.X,{children:b||"Contract not found"})]})]}):(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsxs)(o.z,{variant:"ghost",onClick:()=>f.back(),className:"mb-4",children:[(0,i.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Back to Contracts"]}),(0,i.jsx)(l.s,{data:a,onEdit:()=>{},isLoading:h,error:b})]})}}},function(e){e.O(0,[358,384,328,775,971,117,744],function(){return e(e.s=91085)}),_N_E=e.O()}]);